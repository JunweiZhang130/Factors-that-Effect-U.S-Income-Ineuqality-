---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Another author
thanks: "Code and data are available at: LINK."
date: "`r Sys.time()`"
date-format: "D MMMM YYYY"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(fig.width=6.5, fig.height=2.8) 
# loading in relevant libraries
library(tidyverse)
library(dplyr, warn.conflicts = FALSE)
library(tidyr)
library(readxl)
library(data.table)
library(lubridate)
library(haven)
library(readxl)
library(ggplot2)
### Input data ###
income_sex_data_percentage<-read.csv(here::here("outputs/data/sex_income.csv"))
income_race_data_percentage<-read.csv(here::here("outputs/data/race_income.csv"))
income_employee_status_data_percentage<-read.csv(here::here("outputs/data/income_employee_status_data.csv"))
income_industry_sector_data_percentage<-read.csv(here::here("outputs/data/income_industry_sector_data.csv"))
income_science_course_data_percentage<-read.csv(here::here("outputs/data/income_science_course_data.csv"))
```

# Introduction

You can and should cross-reference sections and sub-sections. For instance, @sec-data and @sec-first-point. 





# Data {#sec-data}
```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-raceincome
#| fig-cap: "U.S. Income Distribution by Sex"

# Make sure the order of the income level is the order we wanted
income_label <- c("LT $1000", "$1000 TO 2999", "$3000 TO 3999", "$4000 TO 4999", "$5000 TO 5999", "$6000 TO 6999", "$7000 TO 7999", "$8000 TO 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 OR MORE")
income_sex_data_percentage$Income <- 
  factor(income_sex_data_percentage$Income, 
         levels = income_label)

# Manually set fill colors and labels
fill_colors <- c("Male" = "#9FC69F", "Female" = "#D6BABA")

ggplot(income_sex_data_percentage, aes(x = Income, 
                                        y = The_Number_Of_People, 
                                        fill = Sex)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = fill_colors) +
  labs(x = "Income Level", y = "Total Number of People",
       title = "U.S. Income Distribution by Sex") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%"), y = The_Number_Of_People + 10), 
            position = position_stack(vjust = 0.5), size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) +
  ylim(0, 420)


```



```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-raceincome
#| fig-cap: "U.S. Income Distribution by Race"

# Make sure the order of the income level is the order we wanted
income_label <- c("LT $1000", "$1000 TO 2999", "$3000 TO 3999", "$4000 TO 4999", "$5000 TO 5999", "$6000 TO 6999", "$7000 TO 7999", "$8000 TO 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 OR MORE")
income_race_data_percentage$Income <- 
  factor(income_race_data_percentage$Income, 
         levels = income_label)

# Manually set fill colors and labels
fill_colors <- c("White" = "#6B5B95", "Black" = "#ADD8E6", "Others" =  "#F5E5C0")
fill_labels <- c("White" = "White", "Black" = "Black", "Others" = "Other")

ggplot(income_race_data_percentage, aes(x = Income, 
                                        y = The_Number_Of_People, 
                                        fill = Race)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = fill_colors, labels = fill_labels) +
  labs(x = "Income Level", y = "Total Number of People",
       title = "U.S. Income Distribution by Race") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%"), y = The_Number_Of_People + 10), 
            position = position_stack(vjust = 0.5), size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) +
  ylim(0, 420)

```




```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-raceincome
#| fig-cap: "U.S. Income Distribution by Employee Status"

# Make sure the order of the income level is the order we wanted
income_label <- c("LT $1000", "$1000 TO 2999", "$3000 TO 3999", "$4000 TO 4999", "$5000 TO 5999", "$6000 TO 6999", "$7000 TO 7999", "$8000 TO 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 OR MORE")
income_employee_status_data_percentage$Income <- 
  factor(income_employee_status_data_percentage$Income, 
         levels = income_label)

# Manually set fill colors and labels
fill_colors <- c("Self-employed" = "#A38863", "Someone else" = "#ADD8E6")

ggplot(income_employee_status_data_percentage, aes(x = Income, 
                                        y = The_Number_Of_People, 
                                        fill = EmployeeStatus)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = fill_colors) +
  labs(x = "Income Level", y = "Total Number of People",
       title = "U.S. Income Distribution by Employee Status") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%"), y = The_Number_Of_People + 10), 
            position = position_stack(vjust = 0.5), size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) +
  ylim(0, 420)

```

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-raceincome
#| fig-cap: "U.S. Income Distribution by Industry Sector"

# Make sure the order of the income level is the order we wanted
income_label <- c("LT $1000", "$1000 TO 2999", "$3000 TO 3999", "$4000 TO 4999", "$5000 TO 5999", "$6000 TO 6999", "$7000 TO 7999", "$8000 TO 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 OR MORE")
income_industry_sector_data_percentage$Income <- 
  factor(income_industry_sector_data_percentage$Income, 
         levels = income_label)

# Manually set fill colors and labels
fill_colors <- c("Government" = "#72b7b7", "Private" = "#c84b4b")

ggplot(income_industry_sector_data_percentage, aes(x = Income, 
                                        y = The_Number_Of_People, 
                                        fill = IndustrySector)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = fill_colors) +
  labs(x = "Income Level", y = "Total Number of People",
       title = "U.S. Income Distribution by Industry Sector") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%"), y = The_Number_Of_People + 10), 
            position = position_stack(vjust = 0.5), size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) +
  ylim(0, 420)
```

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-raceincome
#| fig-cap: "U.S. Income Distribution by College Level Science Courses"

# Make sure the order of the income level is the order we wanted
income_label <- c("LT $1000", "$1000 TO 2999", "$3000 TO 3999", "$4000 TO 4999", "$5000 TO 5999", "$6000 TO 6999", "$7000 TO 7999", "$8000 TO 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 OR MORE")
income_science_course_data_percentage$Income <- 
  factor(income_science_course_data_percentage$Income, 
         levels = income_label)

# Manually set fill colors and labels
fill_colors <- c("Yes" = "#DCE3A8", "No" = "#C8BCE5")

ggplot(income_science_course_data_percentage, aes(x = Income, 
                                        y = The_Number_Of_People, 
                                        fill = ScienceCourse)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = fill_colors) +
  labs(x = "Income Level", y = "Total Number of People",
       title = "U.S. Income Distribution by College Level Science Courses") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%"), y = The_Number_Of_People + 10), 
            position = position_stack(vjust = 0.5), size = 2) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8)) +
  ylim(0, 420)
```


# Results

# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


