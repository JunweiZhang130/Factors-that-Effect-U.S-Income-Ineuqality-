---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Another author
thanks: "Code and data are available at: LINK."
date: "`r Sys.time()`"
date-format: "D MMMM YYYY"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---



# Introduction

You can and should cross-reference sections and sub-sections. For instance, @sec-data and @sec-first-point. 

# Methodology

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(fig.width=6.5, fig.height=2.8) 

# loading in relevant libraries
library(cowplot)
library(tidyverse)
library(dplyr, warn.conflicts = FALSE)
library(tidyr)
library(readxl)
library(data.table)
library(lubridate)
library(haven)
library(readxl)
library(ggplot2)
library(scales)

### Input data ###
happiness_data<-read.csv(here::here("outputs/data/happiness_data.csv"))
sex_data<-read.csv(here::here("outputs/data/sex_data.csv"))
race_data<-read.csv(here::here("outputs/data/race_data.csv"))
degree_data<-read.csv(here::here("outputs/data/degree_data.csv"))
employee_status_data<-read.csv(here::here("outputs/data/employee_status_data.csv"))
marital_status_data<-read.csv(here::here("outputs/data/marital_status_data.csv"))

```

# Results
```{r}
#| message: false
#| warning: false
#| echo: false
#| label: fig-1Happiness
#| fig-cap: "Changes in happiness levels from 1972 to 2021"

# generate graph
happy_colors <- c("#FF7F00", "#1F78B4", "#33A02C")

fig1 <- ggplot(happiness_data, aes(x = Year, y = People, fill = Happy_level)) +
  geom_line(aes(group = Happy_level, color = Happy_level), size = 1.2) +
  scale_fill_manual(values = happy_colors) +
  scale_color_manual(values = happy_colors) +
  labs(x = "Year", y = "Number of Respondents", fill = "Happy Level", 
       color = "Happy level")
fig1 <- fig1  +
  draw_label("Trends in happiness levels for different genders from 1972 to 2021", 
             fontface = "bold", 
             size = 12,
             x = 0.5,
             y = 1.05)
fig1
```

```{r, fig.height=6}
#| message: false
#| warning: false
#| echo: false
#| label: fig-2Gender
#| fig-cap: "Trends in happiness levels for different genders from 1972 to 2021"

# Only for female
female_data <- filter(sex_data, Sex == "Female")
gfemale <- ggplot(female_data, 
       aes(y = Year, 
           fill = Happy_level)) + 
  geom_bar(position = "fill") + 
  theme_classic() +
  coord_flip()+
  labs(x = "Year", y = "Number of Respondents", fill = "Happy Level", 
       title = "Female",
       color = "Happy level")

# Only for male
male_data <- filter(sex_data, Sex == "Male")
gmale <- ggplot(male_data, 
       aes(y = Year, 
           fill = Happy_level)) + 
  geom_bar(position = "fill") + 
  theme_classic() +
  coord_flip()+
  labs(x = "Year", y = "Number of Respondents", fill = "Happy Level", 
       title = "Male",
       color = "Happy level")

# group graphs together
fig2 <- plot_grid(gfemale, gmale, ncol = 1,
          label_size = 12,
          label_x = 0.05,
          label_y = 0.9,
          label_fontface = "bold",
          hjust = 0)

fig2 <- fig2  +
  draw_label("Trends in happiness levels for different genders from 1972 to 2021", 
             fontface = "bold", 
             size = 16,
             x = 0.5,
             y = 1.05)
fig2
```



```{r, fig.height=8}
#| message: false
#| warning: false
#| echo: false
#| label: fig-3Race
#| fig-cap: "Trends in happiness levels for different races from 1972 to 2021"

# Only for white
white_data <- filter(race_data, Race == "White")
gwhite <- ggplot(white_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "White people",
           color = "Happy level")

# Only for black
black_data <- filter(race_data, Race == "Black")
gblack <- ggplot(black_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip()+
      labs(y = "Year", x = "Percentages", fill = "Happy Level", 
           title = "black people",
           color = "Happy level")

# Only for others
others_data <- filter(race_data, Race == "Others")
gothers <- ggplot(others_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "other race",
           color = "Happy level")

# group graphs together
fig3 <- plot_grid(gwhite, gblack, gothers, ncol = 1,
          label_size = 14,
          label_x = 0.05,
          label_y = 0.9,
          label_fontface = "bold",
          hjust = 0)

fig3 <- fig3  +
  draw_label("Trends in happiness levels for different races from 1972 to 2021", 
             fontface = "bold", 
             size = 16,
             x = 0.5,
             y = 1.05)
fig3

```

```{r, fig.height=16}
#| message: false
#| warning: false
#| echo: false
#| label: fig-4Degree
#| fig-cap: "Trends in happiness levels for different degrees from 1972 to 2021"

# graph for less than high school
less_high_school_data <- filter(degree_data, Degree == "Less than high school")
glesshighschool <- ggplot(less_high_school_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Less than high school",
           color = "Happy level")

# graph for high school
high_school_data <- filter(degree_data, Degree == "High school")
ghighschool <- ggplot(high_school_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "High school",
           color = "Happy level")

# graph for associate/junior college
junior_data <- filter(degree_data, Degree == "Associate/junior college")
gjunior <- ggplot(junior_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Associate/junior college",
           color = "Happy level")

# graph for bachelor
bachelor_data <- filter(degree_data, Degree == "Bachelor's")
gbachelor <- ggplot(bachelor_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Bachelor",
           color = "Happy level")

# graph for graduate
graduate_data <- filter(degree_data, Degree == "Graduate")
graduate<- ggplot(graduate_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Graduate",
           color = "Happy level")

# group graphs together
fig4 <- plot_grid(glesshighschool, ghighschool, gjunior, gbachelor, graduate, ncol = 1,
          label_size = 14,
          label_x = 0.05,
          label_y = 0.9,
          label_fontface = "bold",
          hjust = 0)

fig4 <- fig4  +
  draw_label("Trends in happiness levels for different degrees from 1972 to 2021", 
             fontface = "bold", 
             size = 16,
             x = 0.5,
             y = 1.05)
fig4
```



```{r, fig.height=8}
#| message: false
#| warning: false
#| echo: false
#| label: fig-5Employee
#| fig-cap: "Trends in happiness levels for different emoloyee status from 1972 to 2021"

# graph for self-employee
self_data <- filter(employee_status_data, Employee_status == "Self-employed")
gself<- ggplot(self_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Self-employed",
           color = "Happy level")

# graph for someone else
someone_data <- filter(employee_status_data, Employee_status == "Someone else")
gsomeone <- ggplot(someone_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Someone else",
           color = "Happy level")

# group graphs together
fig5 <- plot_grid(gself, gsomeone, ncol = 1,
          label_size = 14,
          label_x = 0.05,
          label_y = 0.9,
          label_fontface = "bold",
          hjust = 0)

fig5 <- fig5  +
  draw_label("Trends in happiness levels for different emoloyee status from 1972 to 2021", 
             fontface = "bold", 
             size = 16,
             x = 0.5,
             y = 1.05)
fig5
```




```{r, fig.height=16}
#| message: false
#| warning: false
#| echo: false
#| label: fig-6Marital
#| fig-cap: "Trends in happiness levels for different marital status from 1972 to 2021"

# graph for married
married_data <- filter(marital_status_data, Marital_status == "Married")
gmarried_data <- ggplot(married_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Married",
           color = "Happy level")

# graph for widowed
widowed_data <- filter(marital_status_data, Marital_status == "Widowed")
gwidowed_data <- ggplot(widowed_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Widowed",
           color = "Happy level")

# graph for divorced
divorced_data <- filter(marital_status_data, Marital_status == "Divorced")
gdivorced_data <- ggplot(divorced_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Divorced",
           color = "Happy level")

# graph for separated
separated_data <- filter(marital_status_data, Marital_status == "Separated")
gseparated_data <- ggplot(separated_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Separated",
           color = "Happy level")

# graph for never married
never_married_data <- filter(marital_status_data, Marital_status == "Never married")
gnever_married<- ggplot(never_married_data, 
             aes(y = Year, 
                 fill = Happy_level)) + 
      geom_bar(position = "fill") + 
      theme_classic() +
      coord_flip() +
      labs(y = "Year", x = "Percentage", fill = "Happy Level", 
           title = "Never married",
           color = "Happy level")

# group graphs together
fig6 <- plot_grid(gmarried_data, gnever_married, gwidowed_data, gdivorced_data, gseparated_data, ncol = 1,
          label_size = 14,
          label_x = 0.05,
          label_y = 0.9,
          label_fontface = "bold",
          hjust = 0)

fig6 <- fig6  +
  draw_label("Trends in happiness levels for different emoloyee status from 1972 to 2021", 
             fontface = "bold", 
             size = 16,
             x = 0.5,
             y = 1.05)
fig6
```




```{r}

```


```{r}

```

# Results

# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


